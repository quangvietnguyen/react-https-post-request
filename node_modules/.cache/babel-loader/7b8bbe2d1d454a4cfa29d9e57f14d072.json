{"ast":null,"code":"import _regeneratorRuntime from\"/Users/vietqnguyen/Desktop/React/08-https-request-chap2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/vietqnguyen/Desktop/React/08-https-request-chap2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/vietqnguyen/Desktop/React/08-https-request-chap2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useCallback}from'react';import MoviesList from'./components/MoviesList';import AddMovie from'./components/AddMovie';import'./App.css';function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),movies=_useState2[0],setMovies=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var fetchMoviesHandler=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,data,loadedMovies,key;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsLoading(true);setError(null);_context.prev=2;_context.next=5;return fetch('https://react-http-45535-default-rtdb.firebaseio.com/movies.json');case 5:response=_context.sent;if(response.ok){_context.next=8;break;}throw new Error('Something went wrong!');case 8:_context.next=10;return response.json();case 10:data=_context.sent;loadedMovies=[];for(key in data){loadedMovies.push({id:key,title:data[key].title,openingText:data[key].openingText,releaseDate:data[key].releaseDate});}// const transformedMovies = data.movies.map((movieData) => {\n//   return {\n//     id: movieData.episode_id,\n//     title: movieData.title,\n//     openingText: movieData.opening_crawl,\n//     releaseDate: movieData.release_date,\n//   };\n// });\nsetMovies(loadedMovies);_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](2);setError(_context.t0.message);case 19:setIsLoading(false);case 20:case\"end\":return _context.stop();}}},_callee,null,[[2,16]]);})),[]);useEffect(function(){fetchMoviesHandler();},[fetchMoviesHandler]);function addMovieHandler(_x){return _addMovieHandler.apply(this,arguments);}function _addMovieHandler(){_addMovieHandler=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(movie){var response,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch('https://react-http-45535-default-rtdb.firebaseio.com/movies.json',{method:'POST',body:JSON.stringify(movie),headers:{'Content-Type':'application/json'}});case 2:response=_context2.sent;_context2.next=5;return response.json();case 5:data=_context2.sent;console.log(data);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return _addMovieHandler.apply(this,arguments);}function deleteMoviesHandler(_x2){return _deleteMoviesHandler.apply(this,arguments);}function _deleteMoviesHandler(){_deleteMoviesHandler=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(movie){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch('https://react-http-45535-default-rtdb.firebaseio.com/movies.json',{method:'DELETE'});case 2:response=_context3.sent;case 3:case\"end\":return _context3.stop();}}},_callee3);}));return _deleteMoviesHandler.apply(this,arguments);}var content=/*#__PURE__*/React.createElement(\"p\",null,\"Found no movies.\");if(movies.length>0){content=/*#__PURE__*/React.createElement(MoviesList,{movies:movies});}if(error){content=/*#__PURE__*/React.createElement(\"p\",null,error);}if(isLoading){content=/*#__PURE__*/React.createElement(\"p\",null,\"Loading...\");}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"section\",null,/*#__PURE__*/React.createElement(AddMovie,{onAddMovie:addMovieHandler})),/*#__PURE__*/React.createElement(\"section\",null,/*#__PURE__*/React.createElement(\"button\",{onClick:deleteMoviesHandler},\"Delete Database\")),/*#__PURE__*/React.createElement(\"section\",null,/*#__PURE__*/React.createElement(\"button\",{onClick:fetchMoviesHandler},\"Fetch Movies\")),/*#__PURE__*/React.createElement(\"section\",null,content));}export default App;","map":{"version":3,"sources":["/Users/vietqnguyen/Desktop/React/08-https-request-chap2/src/App.js"],"names":["React","useState","useEffect","useCallback","MoviesList","AddMovie","App","movies","setMovies","isLoading","setIsLoading","error","setError","fetchMoviesHandler","fetch","response","ok","Error","json","data","loadedMovies","key","push","id","title","openingText","releaseDate","message","addMovieHandler","movie","method","body","JSON","stringify","headers","console","log","deleteMoviesHandler","content","length"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\n\nimport MoviesList from './components/MoviesList';\nimport AddMovie from './components/AddMovie';\nimport './App.css';\n\nfunction App() {\n  const [movies, setMovies] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const fetchMoviesHandler = useCallback(async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      const response = await fetch('https://react-http-45535-default-rtdb.firebaseio.com/movies.json');\n      if (!response.ok) {\n        throw new Error('Something went wrong!');\n      }\n\n      const data = await response.json();\n      \n      const loadedMovies = [];\n\n      for (const key in data) {\n        loadedMovies.push({\n          id: key,\n          title: data[key].title,\n          openingText: data[key].openingText,\n          releaseDate: data[key].releaseDate\n        });\n      }\n\n      // const transformedMovies = data.movies.map((movieData) => {\n      //   return {\n      //     id: movieData.episode_id,\n      //     title: movieData.title,\n      //     openingText: movieData.opening_crawl,\n      //     releaseDate: movieData.release_date,\n      //   };\n      // });\n      setMovies(loadedMovies);\n    } catch (error) {\n      setError(error.message);\n    }\n    setIsLoading(false);\n  }, []);\n\n  useEffect(() => {\n    fetchMoviesHandler();\n  }, [fetchMoviesHandler]);\n\n  async function addMovieHandler(movie) {\n    const response = await fetch('https://react-http-45535-default-rtdb.firebaseio.com/movies.json', {\n      method: 'POST',\n      body: JSON.stringify(movie),\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    const data = await response.json();\n    console.log(data)\n  }\n\n  async function deleteMoviesHandler(movie) {\n    const response = await fetch('https://react-http-45535-default-rtdb.firebaseio.com/movies.json', {\n      method: 'DELETE'\n    });\n  }\n\n  let content = <p>Found no movies.</p>;\n\n  if (movies.length > 0) {\n    content = <MoviesList movies={movies} />;\n  }\n\n  if (error) {\n    content = <p>{error}</p>;\n  }\n\n  if (isLoading) {\n    content = <p>Loading...</p>;\n  }\n\n  return (\n    <React.Fragment>\n      <section>\n        <AddMovie onAddMovie={addMovieHandler} />\n      </section>\n      <section>\n        <button onClick={deleteMoviesHandler}>Delete Database</button>\n      </section>\n      <section>\n        <button onClick={fetchMoviesHandler}>Fetch Movies</button>\n      </section>\n      <section>{content}</section>\n    </React.Fragment>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}